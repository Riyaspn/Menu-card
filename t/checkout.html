<!doctype html> <html lang="en"> <head> <meta charset="utf-8"> <title>Checkout</title> <meta name="viewport" content="width=device-width, initial-scale=1"> <style> body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin:0; background:#fafafa; color:#222; } header { position: sticky; top:0; background:#fff; border-bottom:1px solid #eee; padding:12px 16px; } .container { padding:16px; max-width:720px; margin:0 auto; } .card { background:#fff; border:1px solid #eee; border-radius:8px; padding:12px; margin-bottom:12px; } .row { display:flex; justify-content:space-between; align-items:center; padding:6px 0; gap:8px; } .btn { background:#111; color:#fff; border:none; padding:10px 12px; border-radius:6px; cursor:pointer; width:100%; } .btn:disabled { opacity:.6; cursor:not-allowed; } .muted { color:#666; } .qty { display:inline-flex; gap:8px; align-items:center; } .qty button { padding:4px 10px; } a { color: inherit; text-decoration: none; } </style> </head> <body> <header> <strong>Checkout</strong> </header> <div class="container"> <div id="meta" class="muted" style="margin:8px 0 12px;"></div>

<div id="items" class="card"></div>

<div class="card">
  <button id="payCash" class="btn">Pay Cash at Table</button>
  <div style="height:8px"></div>
  <button id="payUPI" class="btn">Pay by UPI (Demo)</button>
</div>

<div id="msg" class="muted"></div>
</div> <script> // Read restaurant and table from query string const params = new URLSearchParams(location.search); const restaurantId = params.get('r') || 'DEMO_RESTAURANT'; const tableId = params.get('t') || 'TABLE_X'; document.getElementById('meta').textContent = `Restaurant: ${restaurantId} — Table: ${tableId}`; // Cart storage key const CART_KEY = `cart:${restaurantId}:${tableId}`; // Simple item master (same IDs as t/index.html) const itemsMaster = { 1: { name:'Margherita Pizza', price:249 }, 2: { name:'Paneer Tikka', price:199 }, 3: { name:'Masala Fries', price:129 } }; function loadCartObj() { const raw = localStorage.getItem(CART_KEY); return raw ? JSON.parse(raw) : {}; } function saveCartObj(obj) { localStorage.setItem(CART_KEY, JSON.stringify(obj)); } function clearCart() { localStorage.removeItem(CART_KEY); } function render() { const cart = loadCartObj(); const itemsEl = document.getElementById('items'); const entries = Object.entries(cart); if (entries.length === 0) { itemsEl.innerHTML = '<div class="muted">Your cart is empty.</div>'; return { total: 0, cart }; } let total = 0; const rows = entries.map(([id, qty]) => { const m = itemsMaster[id]; if (!m) return ''; const line = m.price * qty; total += line; return ` <div class="row"> <div style="flex:1">${m.name}</div> <div class="qty"> <button onclick="dec(${id})">−</button> <span>${qty}</span> <button onclick="inc(${id})">+</button> </div> <div>₹${line}</div> </div> `; }).join(''); itemsEl.innerHTML = rows + `<hr/> <div class="row"><div>Subtotal</div><div>₹${total}</div></div> <div class="row"><strong>Total</strong><strong>₹${total}</strong></div>`; return { total, cart }; } function inc(id) { const cart = loadCartObj(); cart[id] = (cart[id] || 0) + 1; saveCartObj(cart); render(); } function dec(id) { const cart = loadCartObj(); if (!cart[id]) return; cart[id] = cart[id] - 1; if (cart[id] <= 0) delete cart[id]; saveCartObj(cart); render(); } // Initial render render(); // Button actions document.getElementById('payCash').addEventListener('click', () => { document.getElementById('msg').textContent = 'Order placed. Please pay cash to staff.'; clearCart(); }); document.getElementById('payUPI').addEventListener('click', () => { const { total } = render(); // recalc in case of changes if (total <= 0) { document.getElementById('msg').textContent = 'Cart is empty.'; return; } // Demo UPI intent deep link (replace with PSP checkout later) // upi://pay?pa=merchant@bank&pn=Restaurant&am=TOTAL&tn=Note&tr=OrderId&cu=INR const orderId = 'ORD' + Date.now(); const upiUrl = `upi://pay?pa=${encodeURIComponent('merchant@bank')}&pn=${encodeURIComponent(restaurantId)}&am=${encodeURIComponent(total)}&tn=${encodeURIComponent('Table '+tableId)}&tr=${encodeURIComponent(orderId)}&cu=INR`; window.location.href = upiUrl; // For production: redirect to the restaurant’s PSP-hosted checkout (UPI/card) // and mark the order paid on webhook success. }); // Expose qty handlers for inline onclick window.inc = inc; window.dec = dec; </script> </body> </html>
